TO DO UP NEXT:

- Add game master slot. I think this is needed for the milsim community and could help promote the mission.
    - I think that some communities would prefer a controlable unit so they can talk to players with teamspeak acre or tfar.
        I will still add a virtual one because its easy and maybe others will prefer it.
        - If you do a playable unit, civilian would probably be the least to interfear with code, but you would still have to filter
            it out on some conditions.
    - How to add a virtual entity zeus slot on the lobby screen for multiplayer.
        - place virtual zeus. systems > logic entities > zeus
            - give it a variable name, check box playable, write role description.
        - place game master module. systems > modules > zeus > game master
            - in owner field write the variable name of virtual zeus, check box, forced interface.
    - Zeus behavior
        - Can have admin logged and virtual entity zeus at the same time
        - logic entity counts as a player (allplayers, isplayer, etc)
        - logic entity zeus is not attached to the camera, therefore zeus can enter trigger areas with condition: any player present
            without it triggering and messing up the mission.

- Do a quick pass and see how much code this will break.
    - search triggers in editor (93 triggers)
        - current trigger: Removes "Skip to Infill". Starts convo. Silences Marcinko. Deletes triggers.
        - modified triggers:
            - Completes task "Get in STAB".

    - control f allplayers and isplayer in the .sqf's (nothing obvious stands out). Also search all action conditions.
        initPlayerLocal - allplayers/isplayer (no issue),
        onplayerrespawn - allplayers/isplayer (no issue),
        init - allplayers/isplayer (no issue),
        initserver - might not be an issue unless arma gives leader of group to zeus virtual entity.

DEDICATED SERVER TESTING:
- worked on some triggers that let the player know if they are boating in the wrong direction.
- mercinko should have no questions left. but the way its scripted looks like they still will be there.
- fixed issue where the POW was saying SOG voice lines because I changed his object type and forgot to update it in the restrict voices module
- test infil convo for working on dedicated server.
- Test if players still have holdAction after respawn. there is some question as to if they persist.
- Test if skip to infil needs to be remoteexeced. weather and time might not change. you can copy some code from radiohq.sqf
- the sam site targets player which could lead to the pilot not getting shot down. needs more testing to see how often that would happen.
- Any code with _responder might have unit talking to itself. take a look during playtesting.
- If during testing notifications are overlaping each other at the infil spot then consider disabling the notifications for the several tasks 
    and try to use this to create a single notification of "many tasks created" https://community.bistudio.com/wiki/BIS_fnc_showNotification      
- There is some question to how leadership is changed when a leader disconnects. To test it properly we need to setup the laptop and have two
    clients. See if you are able to get the scout to be the group leader with 2 clients connected. He is supposed to be 2nd because of editor
    order but I never could get it to work with local host + client testing. I have added an EH that should reassign leader to a human if
    the AI is ever given leader.

BUGS FROM LATEST PLAYTHROUGH:


TO DO MASTER LIST:
    HIGH PRIORITY:
        
    MEDIUM PRIORITY:
    
    LOW PRIORITY:
        - NPC polish: Adds to immersion at the cost of much dev time:
            - have npc walk to end of pier and salute as boat drives away.
            - have npcs welcome you back at mission end
            - have pilots, pow, downed pilot exit heli at missons end
            - BIS_fnc_ambientAnimCombat and another function that does idle stuff in start area.
            - fill out the prison with prisoners, equipment etc and put hide on it until extract
        - Design: Convos: If people think there is too much talking then have an option to reduce it for SP vs MP. Or on/off for either.
        - Recheck how the Captain debrief is working. Some stuff might have broken. Ditch the performance ratings.
            - i added a failure state for proceed to infil spot
            - I decided to not have performance ratings for players but I like the flavor text
            - I reworked the extract task which can now be failed so I might need to add that as a primary objective.
        - Update all needed pictures in the mission from tasks to victory/death screens. This should be near the last thing you do
            because the mission is ever evolving and what you use now might not be usable later, which results in wasted time.
        - Entire SFX pass for whole project for addactions and hold actions and whatever else you can think of (do this before voices so you can 
            learn the program and workflow)
        - Adjustments to arsenal, inventories, and unit classes to match decription (RTO, medic, etc). I think that the variable name might 
            also show up in the U menu when switching units in singleplayer.
        - Record voice actors (literally the last thing you do), gives plenty of time to refine dialog.
    
    IDEA GRAVEYARD:
        - Design: Add achievements; Perfect mission, never spotted, rescued NPC. I think this is a neat idea but it will add a bunch of
            scope to a project already struggling to find completion. Reevaluate later if you wish.
        - Design: Try to incourage the hand signal module by punishing players using their radios. 
            Send trackers after them if they use it too much. I like this idea but it will add too much scope to the mission.
            Perhaps in the future for another mission or if I ever finish this one with time to spare.
            - This simulates the ability of the enemy to use radio direction finding.
        - Design: Mission fails if friendly fire threshold is reached. I don't think I need to do this.
            - If anyone plays this mission almost certainly they know each other. Let social acceptance guide player behavior here.
            - Players punished by accidental friendly fire can feel can feel like it's unfair or unfun rule.
        - Design: Disable the squad radio chatter. It is vanilla ARMA sounds so it breaks immersion for me. But if I do this then it could
            hamper important game feedback for single players would want AI. Unfortunantley I think we need to keep it unless playtesting
            proves otherwise.
        - Design: If you put on an enemy back pack you get to know if you are being tracked and whatever other info/things could be
            a boon to players. I think this is a neat idea that could play into having an indiginous unit in the group but as it sits 
            right now I don't see the value it can add mechanic wise.
                - Idea: Lets players know if they are currently tracked. 
    ABANDONED STUFF:
        - When the heli flys to base it follows the tree line and tilts back and forth and isn't smooth. I've tried a bunch of commands,
            but nothing seems to stop it. Unless I find someone expert at this or I stumble on a solution it is a wasteful time sink.
        - Design: I think I have to add holdActions to the SAM site stuff for parity. How else do you explain to players why you can use holdAction on the cache
            but not the SAM? I decided not to pursue this because it will add too much time to change the code and have to do more rewriting 
            of it for little payoff of polish. This is a great learning experience on why it is better to make designs in the early part of 
            the mission. The idea here is to have that aspect solidified so that you don't loose time reworking systems or rewriting code. 



TOUGH BUGS:
Bug: It seem's as if you cannout spawn on another player if they have previously died. You can select them but you get red warning 
    that you can't spawn on a dead player.
        - This is inconsistant. Now it's letting me spawn on players again.
            - And now it's not again. Perhaps there is a timer when you repawn that prevents someone spawning on you?
- try addvehicle command to no kick players out of vehicle (not verified since waypoints rework of helicopter extraction)
- scout wont get in the stab
- couldnt access arsenal at cache one time.
- Some sub tasks are out of there main categories. Resolves on mission restart.
- couldn't get in boat until other players exited
- players dont always end up in boat with skip to ingress

    JIP ISSUES:
        - if a player leaves and he had an ai in his group then no one else can control the AI. The AI becomes invincible. maybe the enable damage reverts? I think
        so because this doesnt happen with the POW
        - player may not have access to their loadout from the stab if they have scuba equipped and leave and rejoin.
        - some combination of JIP players coming and going cause some tasks to cycle through when a player joins. Does not seem to affect the sync of the tasks 
        though.
        - If a player leaves and his AI is killed its loadout reverts. Face still working tho.


BEFORE YOU PUBLISH:
read description.ext on wiki to polish load screens, etc
- add mission steam main pic (can be any size but must be square. set 1440x1440 in gimp. use square overlay in splendid camera.)
- two more screen shots. approching village and sinlge file jumngle walk space 10 meters apart.
- add autosaves for SP


TO EXPORT FOR PLAY TESTING ON DEDICATED SERVER:
- Change time to night (00:10)
- adjust respawn settings (on custom position and choose the spawn 60secs1)
- enable intro in init.sqf
- make sure player groups call sign is Rankin and all at the start area
- enable damage for command and scout unit
- move pics files back


FINISHED:
Polish: add player note under mission options that zeus is available in singleplayer, adminlogged, and virtual
Fixed: on singleplayer death, infinite switching to player leadership.
    - Added a condition to the code to only run in Multiplayer
Rework: Change how smoke the LZ task completes, because an edge case could happen where a player is standing outside of the marker
            but throws the grenade into the LZ correctly but fails the task anyway because they were outside when they threw it.
            - Currently: checks if the unit is in a marker.
            - Change to: check if the projectile is in the marker area.
                - Use a new EH that checks to see when the smoke is fired and within the area
    - Now I need to convert the old EH to the new one.
        - Explored the hitSurface EH. It won't work with grenades.
        - Converted to new EH which is a combo of FiredMan and Explode. This works better because it tracks to make sure the smoke is in
            the LZ.
Design Decision: write a script that looks for AI leaders on mission start and then gives the leader to a human.
    - check for a on player connected EH. If not its not a big deal since players can use the map board to change leader.
        - modified the script for the leader changed EH an run this at start. works so far.
Design Decision: let players choose to be the AI leader with the map easle at the arsenal.
    - A situation can occure if players choose to take AI with them. If the leader leaves then the AI will take that players spot.
        This means that the AI is the leader and that no one can control them. The leader changed EH that I have designed to fix when
        AI takes over only works if no AI is taken. In that case the unit no longer exists so the leader must be changed, so the EH fires then.
        - I am using a player disconnected EH to check if the leader of the group is AI then I will assign a leader to a human.
            - The condition is not resolving. Try adding a sleep before the if statement. Consider removing the if Statement.
                - The sleep fixed it. It's like there was a delay where the server though that the leader was a human still even after they
                    disconnected.
Design Decision: I will allow AI to be used in MP. I added a EH that will detect if AI is the leader and give it back to players.
Summary of the group leader mechanic that I've learned so far.
1. There will always be a group leader whether it is AI or human. If only one person starts the mission in MP, they are the leader.
    - The leader wont change with JIP players.
        - Unless the editor placed leader comes into the mission.
    - The leader wont change with death.
        - Might change if respawn is disbled.
    - The leader can change if the leader exits the mission. Unsure of priority for units.
        - They cannot get it back by rejoining.
2. The group leader is defined in the editor.
    - The order you add units to the leader is the same as the order that appears in the lobby and group bar UI (editor order is alphabetical).
        - When testing with two apps open I can't get the local host to be the leader. I wonder if this would change on a dedicated server.
            - The local host is always the leader unless scout or demo is chosen.
- Design: Using AI in a MP Scenario. First you need to find out if group leader is tossed to AI, another player, or not at all
            upon the death of the group leader. Then take a look at some options. I choose option 2. Maybe I can write a script that looks
            for AI leaders on mission start and then gives the leader to a human.
            - option 1: disable AI entirley for MP.
            - option 2: leave as is but if players leave AI on and dont take group leader then itll be jank. Thats on them I think.
            - option 3: If group leader does get passed then use select leader and leader changed EH to avoid AI taking control of the 
                AI or some solution that always passes AI to a player.
    Playtesting:
        - With the groupleader as a player and AI in the mission
            - Seems like leader player is always the group leader. I've died a bunch and it hasn't transfered to anyone else.
        - With the groupleader as an AI and player and AI in the mission.
            - The players dont get control of the AI because the AI groupleader does. You basically can't play like this cause you can't 
                control the AI. So you would turn off AI at mission start unless someone is playing the group leader.
        - The game will assign a human as leader if the group leader unit is not chosen at the lobby (AI or human)
            - The order appears to coincide with the order that units are formed into the group in the editor.
                - In testing I could not get the scout to become the group leader presumably because he was the last unit added. This means
                    he could never become group leader unless he is the only one playing.
                    - I presumed wrong. Even though the scout is the second unit added to the group, I haven't yet been able to get him 
                        to be leader.
                - The order can change based on JIP. For example, I could start the game with just the scout and no other AI or humans. Then,
                    have another human join after the mission has started. Even though any other unit is technically higher up on the priority 
                    list than the scout, the scout will remain the group leader because he was assigned it at mission start. What this tells 
                    me is that I can count on the group leader being rather static,
            - If there is only a single player and no AI, then that person will be group leader.
                - In testing with the pilot the group seems to not exist until you meet the pilot, then the group is created then the 
                    pilot is added. I say this because usually you can see yourself as part of a group with the bar at the bottom left.
                    But if only one person spawns in then there is no bar until you meet the pilot.
                    - Using the command 'leader playergroup', I can see that in this situation the leader is already defined. It is just
                        the UI that gets updated when a single player meets the pilot.
            - If the group leader leaves the game:
                - convo is printed twice
                - group leader is apparently tossed to another player (haven't met the pilot yet)
                - After adding the pilot to the group, if the group leader leaves then the pilot becomes the group leader
                    - If that player returns, the pilot is still the group leader
- Polish: adjust file cabinet a little lower in radio hut.
- Design Decision: Players must use a holdAction on a the general in order to proceed. However the way ARMA works is if that unit is in a vehicle 
    that explodes they disappear. That would mean the players can't complete that task. I will go with option 2.
        Option 1: Add a killed EH that checks if the unit is in his vehicle and TPs him out so players can do the action on the body.
        Option 2: I like that the corpse can't be recovered. It wouldn't break the mission since I redesigned it. 
            And might add a nice layer of challenge for players to only disable the vehicle.
                I will add some player feedback if this event occurs.
                    - Add an EH that check if the general was in the car and if he was then fail the task and have a convo play for the Killer.
Polish: - Intro jeep moves out of sight from players. Delete it after player get to infil.
Polish: - There is a locker in lumphat that keeps clipping into the buildings.
            I disabled simulation of the object and disabled damage. I have a theory that it was getting destroyed and that the death animation
                is similar to houses and the generator where the animation lowers it into the ground, only in this case not fully (bug).
- Reworked: deleting obj from inside huts when they are destroyed or else they float.
    - I have got the EH to fire and even to grab nearby objects and delete them. I even added in the script to spare players and vehicles 
        but in testing there is a problem. It turns out the EH is inconsistant. With certain weapons it will not fire. So I cannot use this 
        EH as a solution to my floating object problem.
        - Next thing to try is to place your own hut and make them invincible. Either that or try to grab them somehow and turn off damage. 
            There is some question as to if this is possible with terrain objects though.
            - I was able to grab the terrain objects with a command and turn damage off for them. It sucks that the mission will loose some
                immersion by not seeing burning buildings, but it is way more immersion breaking to see floating objects after a hut has
                been burned down. Now to test in MP. 
                - Placed it in initServer and had to remoteExec it for it to work.
                    - Advice from Hypoxic: Put the code in initPlayerLocal instead and don't remoteExec.
Polish: Went through all triggers and AI before the infil spot and delete them once players get there for performance. Works if players 
    get there nornamally or with skip to infil.
Design decision: Problem: Switching units in SP will not let the player access holdAction, EH, and whatever else is tied to `player`.
    - After some research I decided that the time/effort required to make it work is not worth it for such an edge case scenario.
        - If feedback/playtesting warrants otherwise I can look back into it. Consult the link which supposedly adds EH to all units.
            https://cbateam.github.io/CBA_A3/docs/files/xeh/fnc_addClassEventHandler-sqf.html
            https://cbateam.github.io/CBA_A3/docs/files/events/fnc_addPlayerEventHandler-sqf.html
- Fixed: put a sleep in the systemchat for the left behind message to play after the convo, just like you did with the pow death.
- Fixed: rtb holdaction doesnt work in MP dedicated server.
- Fixed: rtb holdaction can be viewed from outside the heli
- Updated subtitles in entire mission to include if scout says them with if statements and other methods.
    - This should help with multiplayer. If the scout ever becomes the leader of the player group he will have his own lines.
    - There are many context sensitive spots where the scout can now say his own lines (ex: holdActions)
- Reworked the extraction sequence:
    I need to make a design decision for the extraction sequence. Should I let players be able to leave others behind? 
        I have decided that because it is possible for the helicopter to be destroyed that players need to have the agency to decide when 
            it takes off. If they leave any players or AI behind then they will get a fail for the extract task. I dont want the helicopter to be 
            invincible. The benefeits of it being vuneralble are it's more realistic, leads to more varied gameplay at the LZ, and more player 
            excitement since there is a failure state.
        The helicopter will be a one way trip because otherwise, it will add more scripting complexity without much upside. I can always change if play
            tests show that it would be beneficial.
        - The condition for RTB will be set to a variable.
        - There will be a failure state for extract task.
- Reworked the heli extraction for the third time. This is the best one yet: 
    Find a solution: Heli will leave LZ and land far away if an object is on the coordinate position.
        - Calling the landing outside of 5 meters from the coordinates seems safe.
        - So far all objects on the LZ will trigger the pilot to land elsewhere, no matter how small or flat. Except helipads.
        - The function seems to constantly monitor for obstructions. I can run under at the last moment then it will fly off.
            - Tried to use an invisible helipad but didnt help.
            - Going to try some ideas I posted in discord. If that doesn't work consult pig's code for helis.
            - I don't think that monitoring the LZ and moving the LZ will work because in testing it dosen't seem responsive enough. Still better
                than nothing as a fail safe though. At this point the easiest would be to give player feedback. Have pilot tell the players to
                clear the LZ if they are within 5 meters of the landing point. Also do a trigger for the former.
            - I've been testing the landAt command. The nice thing is it seems like it will force a landing if something blocks its path but 
                it wont process the command successfully if the path is blocked on execution. Maybe I could do a continual check to wait until
                the path is clear then execute the command. After that we should be clear.
            - Progress is okay so far. figure out how to keep engine on. add convo for blocked LZ. adjust sleep time to give players more time.
                - changed the condition for landing to check the return value. If false then moves the helipad 5 meters any direction until landing.
                    - had to do it this way cause apparently even a explosion decal will block a landing.
            - have the heli landing fine. now to get it to base.
            - got it going back to base now. need to do more play testing with fly height and clean up unused stuff in the editor.
            - I added convos if the lz was blocked and unblocked. polished code and tried to get it to break. I think its as good as it is gonna
                be at my current skill level.
                - polished lz blocked systemChat to account for more situations.
- reworked the plant bombs on cache mechanic. changed to holdAction and uses actionIDs to remove duplicates. added more convo lines.
    - can break it by blow up cache with rockets.
    - tested various situations with death a respawn and multiple players placing them.
- changed sabatague icon to destroy and change holdAction from CBA to script.
- reworked how the downed pilot is shot down and added the possibility that the players can destroy the samsite before it can shoot down the plane.
- figured out why control z wasnt working
- reworked: search lumphat should pop-up on infil not mission start
- reworked time bomb on stab to be holdAction and made it so you can only place it on the boat from the outside.
- made some trigger areas with subtitles if the STAB goes in the wrong direction
- Chose a design choice regarding the Infil Task. On one hand, I want objectives to be open ended for players to determine how to complete them. 
    But on the other hand if I want to "tell a story" its better to have very specific things happen, like a specific infil spot. 
    I need to decide what kind of misison do I want to make. Or try a blend of the two.
    Decision: I love the idea of player choice and having the chance to make mistakes without a hard fail state. I also love a very tight story and
    immersive mission. If I plan for both then I can have the best of both worlds. That way on my single-player play through, I get to enact my prefered
    "story" and when other players play then they can have more freedom to make mistakes. Therefore we will go with option 1.
    - option 1: Players allowed to miss the infil spot. If they get spotted by AI then all the tasks that would have popped up from 
        the infil task, will now pop up. If they dont get spotted then when they reach Lumphat tasks will need to pop up. This might require them to back
        track or abandon the destroy STAB task but I guess thats what they get for not paying attention.
    - option 2: End mission if they proceed too far upriver. But this wont stop players entering too early.
    - option 3: End the mission if players reach Lumphat without triggering infil task. 
- Reduced the chance of the mission breaking if players skirt the water and avoid the patrols then the situation can break the mission. 
    the troop transports drive toward the players. crash on the bridge when they try to return to load up and the general cant flee right.
    implemented all options below.
    option 1: make it so the players have a harder time getting to that spot without triggering the fail task
    option 2: move the reinforcement trucks back further where they wont get shot.
    option 3: make another patrol on opposite shore to spot players and fail the task of remain undetected
- completely reworked the way that side tasks are picked and completed, to allow for completion before pickup. i added functions for the lines so 
the hold action is more readable. added more voice lines for certain conditions
- deleted rankin easter egg
- Emptied the pows inventroy
- fixed bug, all patrols spotted player while he was far away. Maybe AI shares info with each other? Removed event handler fromm all patrols after first use.
- fixed fog not clearing after 5 minutes at the infil
- changed hold action icons for equip scuba gear to better fit visual continuity
- changed POW type so it says driver to fit the narritive better
- adjusted codex for clarity.
- fixed time of day and weather not changing on dedicated server. Had to remoteExec them to get them to work.
- reworked the patrol boat tasks in the beginning of the mission to flow better and make more sense.
- adjusted the order and timings of tasks created at the infil spot
- adjusted task wording for clarity (remain undeteced and kill the HVT)
- fixed issue where "remain undetected" task wouldn't pop up at the correct time. The variable was tied to a 60sec trigger. Had to create a separate trigger so the general and troop transport could
leave at separate times. this also helps with vehicle colisions since they travel the same road.
- polished spotted consequences. How it works currently: If patrol 1-4 sees player then turn on loud speakers and send troop 
transport to patrol road: (PlayersSpotted var). If OPFOR in set area sees player turn on tracker and sends troop transport to lumphat after players fined
one side mission. Once you search the general no reinforcements come. General flees after 60sec (var playersspotted) if any patrol sees players.
If the patrols see the boat because it was destroyed then general flees after 60 secs.
- Implemented new search for intel task in lumphat. Now there are several items with randomized locations with randomize chance of finding a task on search.
- converted to new heli extract
-JIP intro type text
-JIP skip to ingress removed near mission start
-JIP skip to ingress
-JIP wait for naval patrol time jump
-JIP scuba gear available
-JIP time bombs
- update briefing screen to current point
- update tasks to current point
- new helo extraction with addactions
- end mission addaction
- ambient voices for blurfor team disabled
- 3 questions for captain added in beginning
- AI and players keep loadoutgear and faces (not JIP friendly)
- optimization pass (most objects have dynamic sim, some got changed to simple obj, but the biggest factor for performance is number of AI and draw distance)
- fade in on mission start
- added new start task 
- built up starting area
- INFINITE SMOKE!!
- added lines for end mission briefing
- update all previous tasks to be completed for skip to ingress.
- added randomized MP chatter
- make mission fail for helicopter dies or all players dead
- added hold actions for skip and rtb and end mission.
- added hold action for wait for patrol and scuba tasks.
- touched up side missions
- POW task should be good. all tested except helicopter and exfil
- rescue pilot task should be good. needs testing and esp at extract
- adjusted naval wait triggers so that you can now fail after passing.
- added fail mission trigger if stab is destroyed before reaching infil point
- added exfil trigger that checks for players in the trigger area and alive and in the extract helicopter
- added pilot trigger that checks for pilot back at base and completes task
- added pow trigger that checks for pilot back at base and completes task
- add side chat to pow heal. "its no use. My leg is ruined". in the future randomize 3 responses.
- moved time bombs to IPL
- adjusted skipwaypoint for troop reinforcements after general is killed.
- updates file in lumphat so they dont clip thorugh objects.
- placed optional tasks on bottom
- added fail task state for extract task and update PRI and SEC main tasks to reflect it
- adjusted size of mask area for smoke lz task so it fires if players arent exaclty on the right spot. gives more leeway
- randomize cloud cover at mission start
- add camo to unit lobby description
- add different smoke grenades to loadouts
- update all dead to be tied to spawn area trigger. that way it cant complete on spawn in (needs testing)
- add sidechat if general escapes
- disable heli in starting area
- move intro questions to be compatible with skip to infil
- add sachels to boat
- fix exfil link in execution
- created history tab and finalized the subtabs with info and pictures.
- randomize blind spawns with AI
- create rough draft script of lines with chatgpt
- work on new search for intel system.
- add subtitle for when all intel has been found. "looks like weve picked this place dry"
- added scout versions of quips in lumphat search task


TO LEARN:
- add extensions to vscode
    - function auto add. check your discord.
- how to use rpt files
    - you would ctrl f your diag line, such as "First Unit"
    - A good general one is "error in" which will pick up all the SQF errors so you can read them at leisure.
        But if you're not using diag_log already then they're probably at the bottom.
    - As I restart scenarios a lot for test purpose, I always try to find "Starting mission" to check for script error since the mission began
    - you can also use a watcher extension that will follow the lowest line in the file as they are created
- how to create a mission with hemtt. consult ace discord.